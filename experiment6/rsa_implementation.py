def gen():
    p = random_prime(2^1024)
    q = random_prime(2^1024)
    e = 65537
    phi = (p-1)*(q-1)
    d = inverse_mod(e,phi)
    return p,q,e,d
p,q,e,d = gen()
N = p*q
print("生成参数")
print("p = ",p)
print("q = ",q)
print("e = ",e)
print("d = ",d)
def encrypt(msg,N,e):
    msg = int.from_bytes(msg)
    c = pow(msg,e,N)
    return c
def decrypt(c,d,N):
    m = pow(c,d,N)
    msg = m.to_bytes((m.bit_length() + 7) // 8)
    return msg
#测试加密
msg = b"I like RSA"
print("明文",msg)
c = encrypt(msg,N,e)
print("加密:",c)
print("解密",decrypt(c,d,N))
msg = randint(1,N)
msg = msg.to_bytes((msg.bit_length() + 7) // 8)
print("随机明文",msg)
c = encrypt(msg,N,e)
print("加密:",c)
%time print("解密",decrypt(c,d,N))

#CRT
def crt_de(c,d,p,q):
    dp = d % (p-1)
    dq = d % (q-1)
    m1 = pow(c,dp,p)
    m2 = pow(c,dq,q)
    m = crt([m1, m2], [p, q])
    return m.to_bytes((m.bit_length() + 7) // 8)
print("随机明文",msg)
c = encrypt(msg,N,e)
print("加密:",c)
%time print("解密",crt_de(c,d,p,q))

##
生成参数
p =  159840060822170306896708509007121221087775800324766469736558085634527348147383455952405919073793990391466343539880996569145960841217967320279006053421873264293053057911267663305799556992670983309132812765729820451569755484760006557142358589920272892313385291643746713541041698150285659952763446463237780315383
q =  53994720018697969687523606701701174086331494800744470831056840668349357802287024348844310160894517607048780536574090139423880155234260149359560767519499576559610835747811460403301345216938595931065168491033807682057614575719965330675439658521330315228232360897903058118311410858994873554873286308063284869247
e =  65537
d =  1269747888945783668587322351557878264351279785197417737797939890446343786953486332877443101656993905830140958764546209005595800903705250024062709623785682578687959896290255541845431049332008448259792418687656120825548096340782914311106822700162152943853239654090576672081850685458039019205532189329426512879382710408047851603842414806248797161486190192778345303989798707007385008715940064199095392725379061500913580720886728954225160943405683490118514008667086653634331620003625399272296255258204370616121370922649783681115387588441893437869917121857718274800332459497494893698683744503873497899799114905590269098825
明文 b'I like RSA'
加密: 7897212906605507605537744650803492419693123696243425009998920169183661080626018199349599600348639211491871629144769924634656814404365620697859539267077289029453014600997119348239670108574831647915072704607756065223166601566109166604237682412399658654663967041154346665821476280465405983488402934096167476018914246457707074361080446426461133727566343726761216340835181132507388592404709690239896731555095397828284205413463676217806897816133069837116950235248306244113845082469624624432033407974366556257203724497316409596780895758343768289946030615423811705215815642846948842483394476747658247094058435786388438910649
解密 b'I like RSA'
随机明文 b'\n\x04\x98w\x1e\x0c\xdc\x8a\x03\xc7|\xb4\xdcS\x8c\x1d\x0f2\xd6_\xf5\x14F\x17G\x8d;X6\xee\xe2\xda\xa9\x02v\x95\xa2&\xfa\x9a\xeb;\xdaN^c\xdag\x8a\x92\xce\x03c\x0cH\xd5\xe6\xf4\x94\x03\x8b\xbd\x98n\xd31\xfe;>Q7\x90\x12:M\x8f\xbbX\x9a\x83\x9a-\xb0\xf1\xcf\x8eAU\x93\xa7\x7f\x95O\xfd<\xde\xb6\xce\xae\x1c\xd7j\xaelr\x90\x9f\xfdj+\x12\xca8\xf3X\xc7`o\x04!\x97\x87\x0f\xde\xd1\xe6\xdf{\xe7\x06#\x0f\x07+)\x987R\x01"\xbc\xa3\xc5\x86\x07\xa1f\xd3\x12\xa0 \x18G\xac\x82\x97_\x8a\x0b\xa8\xf1]\xfcop\xf7`j\xef3%\xa8k\xe3\xcf\xf1c\xb1"8h\x8d4a%q\x93/\x9c\xffo\xa2\xc2\x9bjx#p\xb6\xe4I\x1c\x08\xb24~QQ\xb2\x0b)<g\x9c\xae\x836\x08yV\xb1s\xa3\xcbw3\x94\xec\x87\x00\xde/\t\xfcP6\xdd\x97\xbfz{7t\xbaw\xd6\xb3\x80\xa4\xca\xdd\xaf\tR\xcbW'
加密: 1716485008696668299142583351880354101002109792678459569562586061463059644371492886724634318829605052943218190620885357138715020779620021408951838441044226454756031202771158376686886105271301406192332325004190431310277800241305712800592904977761307572883383436267272697039587656335322976276693713004229377020870699761610841785394175512484696159525068185618214089637388036854989783949636557926966655829747269710403102729150337489019336187460160354440879893050356905578238454342022033408182093107476607063623192348154323636657322877660801728020219560236742790760591996931147810085478354220316424414376736030183430954482
解密 b'\n\x04\x98w\x1e\x0c\xdc\x8a\x03\xc7|\xb4\xdcS\x8c\x1d\x0f2\xd6_\xf5\x14F\x17G\x8d;X6\xee\xe2\xda\xa9\x02v\x95\xa2&\xfa\x9a\xeb;\xdaN^c\xdag\x8a\x92\xce\x03c\x0cH\xd5\xe6\xf4\x94\x03\x8b\xbd\x98n\xd31\xfe;>Q7\x90\x12:M\x8f\xbbX\x9a\x83\x9a-\xb0\xf1\xcf\x8eAU\x93\xa7\x7f\x95O\xfd<\xde\xb6\xce\xae\x1c\xd7j\xaelr\x90\x9f\xfdj+\x12\xca8\xf3X\xc7`o\x04!\x97\x87\x0f\xde\xd1\xe6\xdf{\xe7\x06#\x0f\x07+)\x987R\x01"\xbc\xa3\xc5\x86\x07\xa1f\xd3\x12\xa0 \x18G\xac\x82\x97_\x8a\x0b\xa8\xf1]\xfcop\xf7`j\xef3%\xa8k\xe3\xcf\xf1c\xb1"8h\x8d4a%q\x93/\x9c\xffo\xa2\xc2\x9bjx#p\xb6\xe4I\x1c\x08\xb24~QQ\xb2\x0b)<g\x9c\xae\x836\x08yV\xb1s\xa3\xcbw3\x94\xec\x87\x00\xde/\t\xfcP6\xdd\x97\xbfz{7t\xbaw\xd6\xb3\x80\xa4\xca\xdd\xaf\tR\xcbW'
CPU times: user 2.58 ms, sys: 0 ns, total: 2.58 ms
Wall time: 2.6 ms
随机明文 b'\n\x04\x98w\x1e\x0c\xdc\x8a\x03\xc7|\xb4\xdcS\x8c\x1d\x0f2\xd6_\xf5\x14F\x17G\x8d;X6\xee\xe2\xda\xa9\x02v\x95\xa2&\xfa\x9a\xeb;\xdaN^c\xdag\x8a\x92\xce\x03c\x0cH\xd5\xe6\xf4\x94\x03\x8b\xbd\x98n\xd31\xfe;>Q7\x90\x12:M\x8f\xbbX\x9a\x83\x9a-\xb0\xf1\xcf\x8eAU\x93\xa7\x7f\x95O\xfd<\xde\xb6\xce\xae\x1c\xd7j\xaelr\x90\x9f\xfdj+\x12\xca8\xf3X\xc7`o\x04!\x97\x87\x0f\xde\xd1\xe6\xdf{\xe7\x06#\x0f\x07+)\x987R\x01"\xbc\xa3\xc5\x86\x07\xa1f\xd3\x12\xa0 \x18G\xac\x82\x97_\x8a\x0b\xa8\xf1]\xfcop\xf7`j\xef3%\xa8k\xe3\xcf\xf1c\xb1"8h\x8d4a%q\x93/\x9c\xffo\xa2\xc2\x9bjx#p\xb6\xe4I\x1c\x08\xb24~QQ\xb2\x0b)<g\x9c\xae\x836\x08yV\xb1s\xa3\xcbw3\x94\xec\x87\x00\xde/\t\xfcP6\xdd\x97\xbfz{7t\xbaw\xd6\xb3\x80\xa4\xca\xdd\xaf\tR\xcbW'
加密: 1716485008696668299142583351880354101002109792678459569562586061463059644371492886724634318829605052943218190620885357138715020779620021408951838441044226454756031202771158376686886105271301406192332325004190431310277800241305712800592904977761307572883383436267272697039587656335322976276693713004229377020870699761610841785394175512484696159525068185618214089637388036854989783949636557926966655829747269710403102729150337489019336187460160354440879893050356905578238454342022033408182093107476607063623192348154323636657322877660801728020219560236742790760591996931147810085478354220316424414376736030183430954482
解密 b'\n\x04\x98w\x1e\x0c\xdc\x8a\x03\xc7|\xb4\xdcS\x8c\x1d\x0f2\xd6_\xf5\x14F\x17G\x8d;X6\xee\xe2\xda\xa9\x02v\x95\xa2&\xfa\x9a\xeb;\xdaN^c\xdag\x8a\x92\xce\x03c\x0cH\xd5\xe6\xf4\x94\x03\x8b\xbd\x98n\xd31\xfe;>Q7\x90\x12:M\x8f\xbbX\x9a\x83\x9a-\xb0\xf1\xcf\x8eAU\x93\xa7\x7f\x95O\xfd<\xde\xb6\xce\xae\x1c\xd7j\xaelr\x90\x9f\xfdj+\x12\xca8\xf3X\xc7`o\x04!\x97\x87\x0f\xde\xd1\xe6\xdf{\xe7\x06#\x0f\x07+)\x987R\x01"\xbc\xa3\xc5\x86\x07\xa1f\xd3\x12\xa0 \x18G\xac\x82\x97_\x8a\x0b\xa8\xf1]\xfcop\xf7`j\xef3%\xa8k\xe3\xcf\xf1c\xb1"8h\x8d4a%q\x93/\x9c\xffo\xa2\xc2\x9bjx#p\xb6\xe4I\x1c\x08\xb24~QQ\xb2\x0b)<g\x9c\xae\x836\x08yV\xb1s\xa3\xcbw3\x94\xec\x87\x00\xde/\t\xfcP6\xdd\x97\xbfz{7t\xbaw\xd6\xb3\x80\xa4\xca\xdd\xaf\tR\xcbW'
CPU times: user 2.06 ms, sys: 0 ns, total: 2.06 ms
Wall time: 2.06 ms
##
